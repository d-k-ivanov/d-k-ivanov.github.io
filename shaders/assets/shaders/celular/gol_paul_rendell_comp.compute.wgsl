// Author: Paul Rendell
// Author's Website: http://rendell-attic.org/gol/tm.htm
// LIF archive: https://d-k-ivanov.github.io/shaders/assets/shaders/celular/gol_paul_rendell_lifs.zip

const COMPUTE_FRAME_INTERVAL : u32 = 3u;

const PATTERN_WIDTH : u32 = 298u;
const PATTERN_HEIGHT : u32 = 428u;
const PATTERN_RUN_COUNT : u32 = 1073u;

struct Run
{
    y : u32,
    x : u32,
    len : u32,
};

// Run-length encoded live cell spans from comp.lif (y, x, len).
const PATTERN_RUNS : array<Run, 1073> = array<Run, 1073>(
    Run(0u, 171u, 1u),
    Run(1u, 170u, 3u),
    Run(2u, 169u, 2u),
    Run(2u, 172u, 1u),
    Run(3u, 169u, 3u),
    Run(4u, 169u, 3u),
    Run(5u, 170u, 2u),
    Run(124u, 216u, 2u),
    Run(125u, 216u, 2u),
    Run(129u, 217u, 1u),
    Run(130u, 216u, 3u),
    Run(131u, 215u, 1u),
    Run(131u, 219u, 1u),
    Run(132u, 214u, 1u),
    Run(132u, 216u, 3u),
    Run(132u, 220u, 1u),
    Run(133u, 215u, 5u),
    Run(134u, 204u, 3u),
    Run(135u, 203u, 1u),
    Run(135u, 207u, 1u),
    Run(136u, 202u, 1u),
    Run(136u, 208u, 1u),
    Run(138u, 201u, 1u),
    Run(138u, 209u, 1u),
    Run(139u, 201u, 1u),
    Run(139u, 209u, 1u),
    Run(139u, 216u, 1u),
    Run(139u, 219u, 2u),
    Run(140u, 216u, 1u),
    Run(140u, 218u, 1u),
    Run(141u, 202u, 1u),
    Run(141u, 208u, 1u),
    Run(141u, 215u, 2u),
    Run(142u, 203u, 1u),
    Run(142u, 207u, 1u),
    Run(142u, 214u, 2u),
    Run(143u, 204u, 3u),
    Run(143u, 214u, 2u),
    Run(143u, 217u, 1u),
    Run(144u, 215u, 3u),
    Run(147u, 216u, 2u),
    Run(147u, 221u, 2u),
    Run(148u, 219u, 1u),
    Run(149u, 216u, 1u),
    Run(149u, 222u, 1u),
    Run(150u, 201u, 1u),
    Run(150u, 208u, 1u),
    Run(150u, 210u, 1u),
    Run(150u, 217u, 2u),
    Run(150u, 220u, 2u),
    Run(151u, 200u, 1u),
    Run(151u, 208u, 2u),
    Run(151u, 218u, 1u),
    Run(151u, 220u, 1u),
    Run(152u, 200u, 3u),
    Run(152u, 209u, 1u),
    Run(152u, 219u, 1u),
    Run(153u, 219u, 1u),
    Run(158u, 218u, 2u),
    Run(159u, 218u, 2u),
    Run(160u, 177u, 2u),
    Run(160u, 210u, 2u),
    Run(161u, 156u, 2u),
    Run(161u, 178u, 1u),
    Run(161u, 210u, 1u),
    Run(161u, 212u, 1u),
    Run(162u, 156u, 2u),
    Run(162u, 178u, 1u),
    Run(162u, 180u, 1u),
    Run(162u, 205u, 2u),
    Run(162u, 211u, 3u),
    Run(163u, 179u, 2u),
    Run(163u, 201u, 1u),
    Run(163u, 204u, 1u),
    Run(163u, 207u, 1u),
    Run(163u, 212u, 3u),
    Run(164u, 200u, 1u),
    Run(164u, 202u, 2u),
    Run(164u, 205u, 2u),
    Run(164u, 211u, 3u),
    Run(165u, 156u, 1u),
    Run(165u, 199u, 1u),
    Run(165u, 203u, 1u),
    Run(165u, 210u, 1u),
    Run(165u, 212u, 1u),
    Run(165u, 219u, 2u),
    Run(166u, 155u, 3u),
    Run(166u, 199u, 5u),
    Run(166u, 210u, 2u),
    Run(166u, 219u, 1u),
    Run(166u, 221u, 1u),
    Run(167u, 154u, 1u),
    Run(167u, 158u, 1u),
    Run(167u, 198u, 2u),
    Run(167u, 203u, 2u),
    Run(167u, 221u, 1u),
    Run(168u, 156u, 1u),
    Run(168u, 199u, 5u),
    Run(168u, 221u, 2u),
    Run(169u, 153u, 1u),
    Run(169u, 159u, 1u),
    Run(169u, 186u, 3u),
    Run(169u, 200u, 3u),
    Run(170u, 153u, 1u),
    Run(170u, 159u, 1u),
    Run(170u, 186u, 1u),
    Run(170u, 201u, 1u),
    Run(171u, 154u, 1u),
    Run(171u, 158u, 1u),
    Run(171u, 187u, 1u),
    Run(172u, 155u, 3u),
    Run(172u, 212u, 1u),
    Run(173u, 212u, 1u),
    Run(173u, 214u, 1u),
    Run(174u, 215u, 2u),
    Run(174u, 221u, 2u),
    Run(175u, 185u, 1u),
    Run(175u, 215u, 2u),
    Run(175u, 221u, 2u),
    Run(176u, 162u, 2u),
    Run(176u, 183u, 3u),
    Run(176u, 194u, 2u),
    Run(176u, 215u, 2u),
    Run(177u, 158u, 1u),
    Run(177u, 163u, 1u),
    Run(177u, 182u, 1u),
    Run(177u, 194u, 1u),
    Run(177u, 196u, 1u),
    Run(177u, 212u, 1u),
    Run(177u, 214u, 1u),
    Run(177u, 260u, 2u),
    Run(178u, 163u, 1u),
    Run(178u, 165u, 1u),
    Run(178u, 182u, 2u),
    Run(178u, 194u, 1u),
    Run(178u, 212u, 1u),
    Run(178u, 260u, 1u),
    Run(179u, 164u, 2u),
    Run(179u, 250u, 1u),
    Run(179u, 258u, 1u),
    Run(179u, 260u, 1u),
    Run(180u, 158u, 1u),
    Run(180u, 250u, 1u),
    Run(180u, 252u, 1u),
    Run(180u, 258u, 2u),
    Run(181u, 156u, 1u),
    Run(181u, 158u, 1u),
    Run(181u, 253u, 2u),
    Run(182u, 157u, 2u),
    Run(182u, 253u, 2u),
    Run(182u, 271u, 1u),
    Run(183u, 180u, 1u),
    Run(183u, 253u, 2u),
    Run(183u, 271u, 3u),
    Run(184u, 171u, 2u),
    Run(184u, 179u, 3u),
    Run(184u, 201u, 3u),
    Run(184u, 241u, 2u),
    Run(184u, 250u, 1u),
    Run(184u, 252u, 1u),
    Run(184u, 274u, 1u),
    Run(185u, 171u, 2u),
    Run(185u, 178u, 5u),
    Run(185u, 201u, 1u),
    Run(185u, 240u, 1u),
    Run(185u, 242u, 1u),
    Run(185u, 250u, 1u),
    Run(185u, 273u, 2u),
    Run(186u, 151u, 2u),
    Run(186u, 156u, 2u),
    Run(186u, 177u, 1u),
    Run(186u, 179u, 1u),
    Run(186u, 181u, 1u),
    Run(186u, 183u, 1u),
    Run(186u, 202u, 1u),
    Run(186u, 240u, 1u),
    Run(186u, 261u, 1u),
    Run(187u, 165u, 1u),
    Run(187u, 177u, 2u),
    Run(187u, 182u, 2u),
    Run(187u, 239u, 2u),
    Run(187u, 252u, 1u),
    Run(187u, 260u, 2u),
    Run(188u, 152u, 1u),
    Run(188u, 156u, 1u),
    Run(188u, 166u, 1u),
    Run(188u, 251u, 1u),
    Run(188u, 260u, 1u),
    Run(188u, 262u, 1u),
    Run(189u, 153u, 3u),
    Run(189u, 164u, 3u),
    Run(189u, 251u, 3u),
    Run(190u, 153u, 3u),
    Run(190u, 177u, 2u),
    Run(191u, 177u, 2u),
    Run(192u, 176u, 1u),
    Run(192u, 199u, 2u),
    Run(192u, 222u, 2u),
    Run(193u, 157u, 2u),
    Run(193u, 176u, 3u),
    Run(193u, 197u, 1u),
    Run(193u, 202u, 1u),
    Run(193u, 220u, 1u),
    Run(193u, 225u, 1u),
    Run(193u, 275u, 3u),
    Run(194u, 157u, 1u),
    Run(194u, 159u, 1u),
    Run(194u, 180u, 1u),
    Run(194u, 196u, 1u),
    Run(194u, 203u, 1u),
    Run(194u, 219u, 1u),
    Run(194u, 226u, 1u),
    Run(194u, 236u, 1u),
    Run(194u, 268u, 2u),
    Run(194u, 274u, 1u),
    Run(194u, 278u, 1u),
    Run(195u, 152u, 2u),
    Run(195u, 160u, 1u),
    Run(195u, 176u, 5u),
    Run(195u, 195u, 1u),
    Run(195u, 204u, 1u),
    Run(195u, 218u, 1u),
    Run(195u, 227u, 1u),
    Run(195u, 236u, 3u),
    Run(195u, 256u, 1u),
    Run(195u, 267u, 2u),
    Run(195u, 273u, 1u),
    Run(195u, 279u, 1u),
    Run(196u, 148u, 2u),
    Run(196u, 151u, 1u),
    Run(196u, 154u, 1u),
    Run(196u, 157u, 1u),
    Run(196u, 160u, 1u),
    Run(196u, 178u, 2u),
    Run(196u, 195u, 1u),
    Run(196u, 204u, 1u),
    Run(196u, 208u, 1u),
    Run(196u, 218u, 1u),
    Run(196u, 227u, 1u),
    Run(196u, 239u, 1u),
    Run(196u, 256u, 3u),
    Run(196u, 269u, 1u),
    Run(196u, 273u, 1u),
    Run(196u, 279u, 1u),
    Run(197u, 148u, 2u),
    Run(197u, 152u, 2u),
    Run(197u, 160u, 1u),
    Run(197u, 195u, 1u),
    Run(197u, 204u, 1u),
    Run(197u, 218u, 1u),
    Run(197u, 227u, 1u),
    Run(197u, 238u, 2u),
    Run(197u, 259u, 1u),
    Run(197u, 276u, 1u),
    Run(198u, 157u, 1u),
    Run(198u, 159u, 1u),
    Run(198u, 196u, 1u),
    Run(198u, 203u, 1u),
    Run(198u, 219u, 1u),
    Run(198u, 226u, 1u),
    Run(198u, 239u, 3u),
    Run(198u, 258u, 2u),
    Run(198u, 274u, 1u),
    Run(198u, 278u, 1u),
    Run(199u, 157u, 2u),
    Run(199u, 175u, 2u),
    Run(199u, 180u, 2u),
    Run(199u, 197u, 1u),
    Run(199u, 202u, 1u),
    Run(199u, 220u, 1u),
    Run(199u, 225u, 1u),
    Run(199u, 240u, 1u),
    Run(199u, 242u, 1u),
    Run(199u, 259u, 3u),
    Run(199u, 275u, 3u),
    Run(200u, 176u, 5u),
    Run(200u, 199u, 2u),
    Run(200u, 222u, 2u),
    Run(200u, 240u, 1u),
    Run(200u, 242u, 1u),
    Run(200u, 260u, 1u),
    Run(200u, 262u, 1u),
    Run(200u, 276u, 1u),
    Run(201u, 168u, 1u),
    Run(201u, 176u, 2u),
    Run(201u, 179u, 2u),
    Run(201u, 241u, 1u),
    Run(201u, 259u, 1u),
    Run(201u, 263u, 1u),
    Run(202u, 167u, 3u),
    Run(202u, 176u, 2u),
    Run(202u, 179u, 2u),
    Run(202u, 259u, 5u),
    Run(202u, 278u, 2u),
    Run(203u, 166u, 5u),
    Run(203u, 177u, 3u),
    Run(203u, 258u, 2u),
    Run(203u, 263u, 2u),
    Run(203u, 271u, 3u),
    Run(203u, 278u, 1u),
    Run(204u, 165u, 2u),
    Run(204u, 170u, 2u),
    Run(204u, 238u, 2u),
    Run(204u, 241u, 1u),
    Run(204u, 243u, 2u),
    Run(204u, 248u, 1u),
    Run(204u, 250u, 1u),
    Run(204u, 259u, 5u),
    Run(204u, 273u, 1u),
    Run(204u, 279u, 3u),
    Run(205u, 238u, 1u),
    Run(205u, 244u, 1u),
    Run(205u, 249u, 2u),
    Run(205u, 260u, 3u),
    Run(205u, 272u, 1u),
    Run(205u, 281u, 1u),
    Run(206u, 203u, 1u),
    Run(206u, 239u, 1u),
    Run(206u, 243u, 1u),
    Run(206u, 249u, 1u),
    Run(206u, 261u, 1u),
    Run(206u, 277u, 1u),
    Run(207u, 175u, 2u),
    Run(207u, 191u, 2u),
    Run(207u, 203u, 2u),
    Run(207u, 240u, 3u),
    Run(207u, 275u, 3u),
    Run(208u, 167u, 3u),
    Run(208u, 176u, 1u),
    Run(208u, 191u, 2u),
    Run(208u, 202u, 1u),
    Run(208u, 204u, 1u),
    Run(208u, 274u, 1u),
    Run(209u, 167u, 3u),
    Run(209u, 173u, 3u),
    Run(209u, 182u, 2u),
    Run(209u, 187u, 1u),
    Run(209u, 194u, 2u),
    Run(209u, 208u, 2u),
    Run(209u, 224u, 1u),
    Run(209u, 274u, 2u),
    Run(210u, 173u, 1u),
    Run(210u, 182u, 1u),
    Run(210u, 184u, 1u),
    Run(210u, 188u, 1u),
    Run(210u, 194u, 3u),
    Run(210u, 207u, 1u),
    Run(210u, 211u, 1u),
    Run(210u, 223u, 2u),
    Run(210u, 264u, 2u),
    Run(211u, 183u, 5u),
    Run(211u, 194u, 2u),
    Run(211u, 206u, 1u),
    Run(211u, 212u, 1u),
    Run(211u, 223u, 1u),
    Run(211u, 225u, 1u),
    Run(211u, 263u, 1u),
    Run(211u, 265u, 1u),
    Run(212u, 168u, 2u),
    Run(212u, 184u, 3u),
    Run(212u, 191u, 2u),
    Run(212u, 206u, 1u),
    Run(212u, 210u, 1u),
    Run(212u, 213u, 1u),
    Run(212u, 265u, 1u),
    Run(213u, 168u, 2u),
    Run(213u, 191u, 2u),
    Run(213u, 206u, 1u),
    Run(214u, 207u, 1u),
    Run(214u, 211u, 1u),
    Run(214u, 215u, 1u),
    Run(214u, 238u, 2u),
    Run(215u, 208u, 2u),
    Run(215u, 213u, 2u),
    Run(215u, 216u, 1u),
    Run(215u, 239u, 1u),
    Run(215u, 269u, 2u),
    Run(215u, 274u, 2u),
    Run(216u, 216u, 1u),
    Run(216u, 236u, 3u),
    Run(216u, 257u, 3u),
    Run(216u, 269u, 2u),
    Run(216u, 274u, 2u),
    Run(217u, 5u, 2u),
    Run(217u, 57u, 1u),
    Run(217u, 59u, 1u),
    Run(217u, 216u, 2u),
    Run(217u, 231u, 2u),
    Run(217u, 236u, 1u),
    Run(217u, 257u, 3u),
    Run(217u, 266u, 1u),
    Run(217u, 270u, 5u),
    Run(218u, 5u, 2u),
    Run(218u, 57u, 1u),
    Run(218u, 60u, 1u),
    Run(218u, 230u, 2u),
    Run(218u, 251u, 1u),
    Run(218u, 256u, 1u),
    Run(218u, 260u, 1u),
    Run(218u, 265u, 2u),
    Run(218u, 271u, 1u),
    Run(218u, 273u, 1u),
    Run(219u, 42u, 1u),
    Run(219u, 49u, 1u),
    Run(219u, 60u, 2u),
    Run(219u, 232u, 1u),
    Run(219u, 250u, 1u),
    Run(219u, 255u, 1u),
    Run(219u, 261u, 1u),
    Run(219u, 265u, 1u),
    Run(219u, 267u, 1u),
    Run(220u, 41u, 1u),
    Run(220u, 43u, 1u),
    Run(220u, 49u, 1u),
    Run(220u, 58u, 1u),
    Run(220u, 62u, 2u),
    Run(220u, 68u, 2u),
    Run(220u, 213u, 1u),
    Run(220u, 250u, 3u),
    Run(220u, 256u, 1u),
    Run(220u, 260u, 1u),
    Run(220u, 271u, 3u),
    Run(221u, 4u, 3u),
    Run(221u, 40u, 1u),
    Run(221u, 42u, 2u),
    Run(221u, 50u, 1u),
    Run(221u, 60u, 2u),
    Run(221u, 68u, 2u),
    Run(221u, 198u, 2u),
    Run(221u, 212u, 1u),
    Run(221u, 214u, 1u),
    Run(221u, 257u, 3u),
    Run(222u, 4u, 3u),
    Run(222u, 34u, 2u),
    Run(222u, 39u, 2u),
    Run(222u, 42u, 2u),
    Run(222u, 53u, 2u),
    Run(222u, 57u, 1u),
    Run(222u, 60u, 1u),
    Run(222u, 198u, 2u),
    Run(222u, 212u, 2u),
    Run(222u, 215u, 1u),
    Run(223u, 34u, 2u),
    Run(223u, 40u, 1u),
    Run(223u, 42u, 2u),
    Run(223u, 49u, 3u),
    Run(223u, 54u, 1u),
    Run(223u, 57u, 1u),
    Run(223u, 59u, 1u),
    Run(223u, 212u, 2u),
    Run(223u, 215u, 2u),
    Run(224u, 41u, 1u),
    Run(224u, 43u, 1u),
    Run(224u, 51u, 4u),
    Run(224u, 212u, 2u),
    Run(224u, 215u, 1u),
    Run(224u, 239u, 1u),
    Run(225u, 42u, 1u),
    Run(225u, 52u, 2u),
    Run(225u, 177u, 6u),
    Run(225u, 212u, 1u),
    Run(225u, 214u, 1u),
    Run(225u, 238u, 2u),
    Run(225u, 270u, 1u),
    Run(226u, 2u, 2u),
    Run(226u, 7u, 2u),
    Run(226u, 176u, 1u),
    Run(226u, 183u, 1u),
    Run(226u, 213u, 1u),
    Run(226u, 238u, 1u),
    Run(226u, 240u, 1u),
    Run(226u, 243u, 1u),
    Run(226u, 269u, 1u),
    Run(226u, 271u, 1u),
    Run(227u, 3u, 5u),
    Run(227u, 36u, 1u),
    Run(227u, 38u, 1u),
    Run(227u, 175u, 1u),
    Run(227u, 184u, 1u),
    Run(227u, 194u, 3u),
    Run(227u, 243u, 1u),
    Run(227u, 245u, 1u),
    Run(227u, 268u, 1u),
    Run(227u, 272u, 1u),
    Run(228u, 4u, 3u),
    Run(228u, 31u, 1u),
    Run(228u, 36u, 1u),
    Run(228u, 39u, 1u),
    Run(228u, 69u, 1u),
    Run(228u, 176u, 1u),
    Run(228u, 183u, 1u),
    Run(228u, 196u, 1u),
    Run(228u, 243u, 2u),
    Run(228u, 269u, 3u),
    Run(229u, 5u, 1u),
    Run(229u, 32u, 2u),
    Run(229u, 39u, 2u),
    Run(229u, 60u, 1u),
    Run(229u, 67u, 3u),
    Run(229u, 177u, 6u),
    Run(229u, 195u, 1u),
    Run(229u, 260u, 2u),
    Run(229u, 267u, 2u),
    Run(229u, 272u, 2u),
    Run(230u, 27u, 2u),
    Run(230u, 37u, 1u),
    Run(230u, 41u, 2u),
    Run(230u, 48u, 1u),
    Run(230u, 61u, 2u),
    Run(230u, 66u, 1u),
    Run(230u, 215u, 3u),
    Run(230u, 239u, 2u),
    Run(230u, 260u, 1u),
    Run(231u, 27u, 2u),
    Run(231u, 39u, 2u),
    Run(231u, 47u, 1u),
    Run(231u, 49u, 1u),
    Run(231u, 60u, 2u),
    Run(231u, 67u, 1u),
    Run(231u, 214u, 2u),
    Run(231u, 217u, 2u),
    Run(231u, 238u, 1u),
    Run(231u, 240u, 1u),
    Run(231u, 261u, 3u),
    Run(232u, 36u, 1u),
    Run(232u, 39u, 1u),
    Run(232u, 46u, 1u),
    Run(232u, 50u, 1u),
    Run(232u, 64u, 1u),
    Run(232u, 67u, 1u),
    Run(232u, 204u, 1u),
    Run(232u, 214u, 2u),
    Run(232u, 217u, 2u),
    Run(232u, 240u, 1u),
    Run(232u, 246u, 2u),
    Run(232u, 263u, 1u),
    Run(233u, 10u, 2u),
    Run(233u, 36u, 1u),
    Run(233u, 38u, 1u),
    Run(233u, 47u, 3u),
    Run(233u, 63u, 1u),
    Run(233u, 203u, 3u),
    Run(233u, 214u, 5u),
    Run(233u, 245u, 2u),
    Run(234u, 11u, 1u),
    Run(234u, 45u, 2u),
    Run(234u, 50u, 2u),
    Run(234u, 63u, 1u),
    Run(234u, 65u, 1u),
    Run(234u, 187u, 2u),
    Run(234u, 202u, 5u),
    Run(234u, 213u, 2u),
    Run(234u, 218u, 2u),
    Run(234u, 247u, 1u),
    Run(234u, 257u, 1u),
    Run(235u, 11u, 1u),
    Run(235u, 13u, 1u),
    Run(235u, 20u, 1u),
    Run(235u, 22u, 1u),
    Run(235u, 64u, 1u),
    Run(235u, 186u, 1u),
    Run(235u, 188u, 1u),
    Run(235u, 201u, 2u),
    Run(235u, 206u, 2u),
    Run(235u, 255u, 1u),
    Run(235u, 257u, 1u),
    Run(236u, 6u, 1u),
    Run(236u, 12u, 2u),
    Run(236u, 19u, 1u),
    Run(236u, 22u, 1u),
    Run(236u, 176u, 1u),
    Run(236u, 188u, 1u),
    Run(236u, 243u, 2u),
    Run(236u, 254u, 1u),
    Run(236u, 256u, 1u),
    Run(237u, 7u, 2u),
    Run(237u, 18u, 2u),
    Run(237u, 30u, 1u),
    Run(237u, 37u, 1u),
    Run(237u, 176u, 1u),
    Run(237u, 178u, 1u),
    Run(237u, 243u, 3u),
    Run(237u, 253u, 1u),
    Run(237u, 256u, 1u),
    Run(238u, 6u, 2u),
    Run(238u, 16u, 2u),
    Run(238u, 21u, 1u),
    Run(238u, 30u, 1u),
    Run(238u, 36u, 1u),
    Run(238u, 38u, 1u),
    Run(238u, 55u, 1u),
    Run(238u, 61u, 2u),
    Run(238u, 66u, 2u),
    Run(238u, 165u, 2u),
    Run(238u, 179u, 2u),
    Run(238u, 190u, 2u),
    Run(238u, 203u, 1u),
    Run(238u, 231u, 3u),
    Run(238u, 245u, 2u),
    Run(238u, 248u, 1u),
    Run(238u, 254u, 1u),
    Run(238u, 256u, 1u),
    Run(238u, 272u, 2u),
    Run(239u, 18u, 2u),
    Run(239u, 29u, 1u),
    Run(239u, 36u, 2u),
    Run(239u, 39u, 1u),
    Run(239u, 50u, 1u),
    Run(239u, 55u, 1u),
    Run(239u, 57u, 1u),
    Run(239u, 61u, 1u),
    Run(239u, 63u, 1u),
    Run(239u, 65u, 1u),
    Run(239u, 67u, 1u),
    Run(239u, 165u, 2u),
    Run(239u, 179u, 2u),
    Run(239u, 190u, 2u),
    Run(239u, 203u, 1u),
    Run(239u, 217u, 2u),
    Run(239u, 233u, 1u),
    Run(239u, 245u, 1u),
    Run(239u, 248u, 1u),
    Run(239u, 255u, 1u),
    Run(239u, 257u, 1u),
    Run(239u, 266u, 2u),
    Run(239u, 272u, 1u),
    Run(240u, 19u, 1u),
    Run(240u, 22u, 1u),
    Run(240u, 25u, 2u),
    Run(240u, 36u, 2u),
    Run(240u, 39u, 2u),
    Run(240u, 49u, 1u),
    Run(240u, 55u, 2u),
    Run(240u, 62u, 5u),
    Run(240u, 179u, 2u),
    Run(240u, 187u, 2u),
    Run(240u, 195u, 1u),
    Run(240u, 199u, 2u),
    Run(240u, 232u, 1u),
    Run(240u, 245u, 2u),
    Run(240u, 248u, 1u),
    Run(240u, 257u, 1u),
    Run(240u, 266u, 1u),
    Run(240u, 268u, 1u),
    Run(240u, 273u, 3u),
    Run(241u, 20u, 1u),
    Run(241u, 22u, 1u),
    Run(241u, 25u, 1u),
    Run(241u, 28u, 3u),
    Run(241u, 36u, 2u),
    Run(241u, 39u, 1u),
    Run(241u, 49u, 2u),
    Run(241u, 63u, 3u),
    Run(241u, 176u, 1u),
    Run(241u, 178u, 1u),
    Run(241u, 186u, 3u),
    Run(241u, 194u, 1u),
    Run(241u, 198u, 1u),
    Run(241u, 200u, 1u),
    Run(241u, 206u, 2u),
    Run(241u, 236u, 2u),
    Run(241u, 243u, 3u),
    Run(241u, 268u, 1u),
    Run(241u, 275u, 1u),
    Run(242u, 25u, 4u),
    Run(242u, 36u, 1u),
    Run(242u, 38u, 1u),
    Run(242u, 42u, 2u),
    Run(242u, 50u, 1u),
    Run(242u, 64u, 1u),
    Run(242u, 176u, 1u),
    Run(242u, 187u, 2u),
    Run(242u, 195u, 5u),
    Run(242u, 206u, 1u),
    Run(242u, 235u, 1u),
    Run(242u, 237u, 1u),
    Run(242u, 243u, 2u),
    Run(242u, 268u, 2u),
    Run(243u, 0u, 2u),
    Run(243u, 5u, 2u),
    Run(243u, 26u, 2u),
    Run(243u, 37u, 1u),
    Run(243u, 42u, 1u),
    Run(243u, 44u, 1u),
    Run(243u, 190u, 2u),
    Run(243u, 196u, 3u),
    Run(243u, 207u, 3u),
    Run(243u, 215u, 2u),
    Run(243u, 235u, 1u),
    Run(244u, 2u, 3u),
    Run(244u, 13u, 1u),
    Run(244u, 15u, 1u),
    Run(244u, 44u, 1u),
    Run(244u, 52u, 2u),
    Run(244u, 190u, 2u),
    Run(244u, 209u, 1u),
    Run(244u, 215u, 2u),
    Run(244u, 234u, 2u),
    Run(245u, 1u, 1u),
    Run(245u, 5u, 1u),
    Run(245u, 14u, 2u),
    Run(245u, 44u, 2u),
    Run(245u, 54u, 1u),
    Run(245u, 296u, 2u),
    Run(246u, 2u, 1u),
    Run(246u, 4u, 1u),
    Run(246u, 14u, 1u),
    Run(246u, 49u, 1u),
    Run(246u, 53u, 1u),
    Run(246u, 296u, 1u),
    Run(247u, 3u, 1u),
    Run(247u, 49u, 1u),
    Run(247u, 66u, 2u),
    Run(247u, 294u, 1u),
    Run(247u, 296u, 1u),
    Run(248u, 38u, 1u),
    Run(248u, 41u, 1u),
    Run(248u, 50u, 1u),
    Run(248u, 65u, 1u),
    Run(248u, 68u, 1u),
    Run(248u, 294u, 2u),
    Run(249u, 24u, 4u),
    Run(249u, 42u, 1u),
    Run(249u, 53u, 5u),
    Run(249u, 65u, 1u),
    Run(249u, 83u, 5u),
    Run(249u, 113u, 5u),
    Run(249u, 203u, 5u),
    Run(249u, 233u, 5u),
    Run(250u, 23u, 1u),
    Run(250u, 27u, 1u),
    Run(250u, 38u, 1u),
    Run(250u, 42u, 1u),
    Run(250u, 52u, 1u),
    Run(250u, 57u, 1u),
    Run(250u, 67u, 2u),
    Run(250u, 82u, 1u),
    Run(250u, 87u, 1u),
    Run(250u, 112u, 1u),
    Run(250u, 117u, 1u),
    Run(250u, 202u, 1u),
    Run(250u, 207u, 1u),
    Run(250u, 232u, 1u),
    Run(250u, 237u, 1u),
    Run(251u, 3u, 2u),
    Run(251u, 27u, 1u),
    Run(251u, 39u, 4u),
    Run(251u, 57u, 1u),
    Run(251u, 66u, 1u),
    Run(251u, 87u, 1u),
    Run(251u, 117u, 1u),
    Run(251u, 207u, 1u),
    Run(251u, 237u, 1u),
    Run(252u, 3u, 2u),
    Run(252u, 23u, 1u),
    Run(252u, 26u, 1u),
    Run(252u, 53u, 1u),
    Run(252u, 56u, 1u),
    Run(252u, 82u, 1u),
    Run(252u, 86u, 1u),
    Run(252u, 112u, 1u),
    Run(252u, 116u, 1u),
    Run(252u, 202u, 1u),
    Run(252u, 206u, 1u),
    Run(252u, 232u, 1u),
    Run(252u, 236u, 1u),
    Run(253u, 9u, 1u),
    Run(253u, 11u, 1u),
    Run(253u, 84u, 1u),
    Run(253u, 114u, 1u),
    Run(253u, 204u, 1u),
    Run(253u, 216u, 3u),
    Run(253u, 234u, 1u),
    Run(254u, 7u, 1u),
    Run(254u, 11u, 1u),
    Run(254u, 17u, 3u),
    Run(254u, 52u, 1u),
    Run(254u, 218u, 1u),
    Run(255u, 0u, 2u),
    Run(255u, 7u, 1u),
    Run(255u, 15u, 1u),
    Run(255u, 17u, 1u),
    Run(255u, 20u, 1u),
    Run(255u, 23u, 2u),
    Run(255u, 46u, 2u),
    Run(255u, 52u, 1u),
    Run(255u, 61u, 1u),
    Run(255u, 217u, 1u),
    Run(256u, 0u, 2u),
    Run(256u, 6u, 1u),
    Run(256u, 11u, 1u),
    Run(256u, 19u, 2u),
    Run(256u, 23u, 1u),
    Run(256u, 26u, 1u),
    Run(256u, 45u, 1u),
    Run(256u, 55u, 1u),
    Run(256u, 60u, 1u),
    Run(256u, 62u, 1u),
    Run(256u, 205u, 1u),
    Run(257u, 7u, 1u),
    Run(257u, 27u, 1u),
    Run(257u, 34u, 2u),
    Run(257u, 46u, 1u),
    Run(257u, 51u, 1u),
    Run(257u, 53u, 1u),
    Run(257u, 55u, 1u),
    Run(257u, 61u, 1u),
    Run(257u, 204u, 2u),
    Run(258u, 7u, 1u),
    Run(258u, 11u, 1u),
    Run(258u, 14u, 3u),
    Run(258u, 27u, 1u),
    Run(258u, 34u, 2u),
    Run(258u, 47u, 1u),
    Run(258u, 55u, 1u),
    Run(258u, 203u, 2u),
    Run(258u, 209u, 2u),
    Run(258u, 216u, 1u),
    Run(259u, 9u, 1u),
    Run(259u, 11u, 1u),
    Run(259u, 27u, 1u),
    Run(259u, 50u, 1u),
    Run(259u, 202u, 3u),
    Run(259u, 209u, 2u),
    Run(259u, 214u, 1u),
    Run(259u, 216u, 1u),
    Run(260u, 23u, 1u),
    Run(260u, 26u, 1u),
    Run(260u, 50u, 1u),
    Run(260u, 52u, 1u),
    Run(260u, 203u, 2u),
    Run(260u, 209u, 2u),
    Run(260u, 213u, 1u),
    Run(260u, 215u, 1u),
    Run(261u, 23u, 2u),
    Run(261u, 48u, 1u),
    Run(261u, 195u, 2u),
    Run(261u, 204u, 2u),
    Run(261u, 212u, 1u),
    Run(261u, 215u, 1u),
    Run(262u, 45u, 1u),
    Run(262u, 53u, 1u),
    Run(262u, 194u, 1u),
    Run(262u, 196u, 1u),
    Run(262u, 205u, 1u),
    Run(262u, 213u, 1u),
    Run(262u, 215u, 1u),
    Run(263u, 44u, 1u),
    Run(263u, 49u, 1u),
    Run(263u, 51u, 1u),
    Run(263u, 53u, 1u),
    Run(263u, 59u, 1u),
    Run(263u, 194u, 1u),
    Run(263u, 214u, 1u),
    Run(263u, 216u, 1u),
    Run(263u, 225u, 2u),
    Run(264u, 43u, 1u),
    Run(264u, 53u, 1u),
    Run(264u, 58u, 1u),
    Run(264u, 60u, 1u),
    Run(264u, 193u, 2u),
    Run(264u, 216u, 1u),
    Run(264u, 225u, 1u),
    Run(264u, 227u, 1u),
    Run(265u, 44u, 2u),
    Run(265u, 50u, 1u),
    Run(265u, 59u, 1u),
    Run(265u, 78u, 2u),
    Run(265u, 227u, 1u),
    Run(266u, 50u, 1u),
    Run(266u, 78u, 1u),
    Run(266u, 80u, 1u),
    Run(266u, 227u, 2u),
    Run(267u, 50u, 1u),
    Run(267u, 78u, 1u),
    Run(273u, 85u, 3u),
    Run(273u, 131u, 1u),
    Run(274u, 85u, 1u),
    Run(274u, 129u, 3u),
    Run(275u, 86u, 1u),
    Run(275u, 128u, 1u),
    Run(276u, 128u, 2u),
    Run(280u, 93u, 2u),
    Run(281u, 93u, 1u),
    Run(281u, 95u, 1u),
    Run(282u, 93u, 1u),
    Run(282u, 119u, 1u),
    Run(282u, 123u, 2u),
    Run(282u, 128u, 2u),
    Run(283u, 117u, 3u),
    Run(283u, 123u, 2u),
    Run(283u, 128u, 2u),
    Run(284u, 116u, 1u),
    Run(285u, 116u, 2u),
    Run(285u, 125u, 3u),
    Run(286u, 125u, 3u),
    Run(287u, 126u, 1u),
    Run(291u, 111u, 2u),
    Run(291u, 116u, 2u),
    Run(292u, 114u, 1u),
    Run(293u, 111u, 1u),
    Run(293u, 117u, 1u),
    Run(293u, 124u, 1u),
    Run(294u, 112u, 2u),
    Run(294u, 115u, 2u),
    Run(294u, 122u, 2u),
    Run(295u, 113u, 1u),
    Run(295u, 115u, 1u),
    Run(295u, 123u, 2u),
    Run(296u, 114u, 1u),
    Run(297u, 114u, 1u),
    Run(297u, 127u, 3u),
    Run(298u, 126u, 1u),
    Run(298u, 130u, 1u),
    Run(299u, 125u, 1u),
    Run(299u, 131u, 1u),
    Run(300u, 125u, 1u),
    Run(300u, 131u, 1u),
    Run(301u, 128u, 1u),
    Run(302u, 126u, 1u),
    Run(302u, 130u, 1u),
    Run(303u, 127u, 1u),
    Run(304u, 128u, 1u),
    Run(304u, 131u, 1u),
    Run(305u, 131u, 1u),
    Run(306u, 130u, 1u),
    Run(307u, 131u, 3u),
    Run(308u, 114u, 2u),
    Run(308u, 119u, 2u),
    Run(308u, 133u, 1u),
    Run(309u, 115u, 5u),
    Run(309u, 137u, 1u),
    Run(310u, 103u, 2u),
    Run(310u, 115u, 2u),
    Run(310u, 118u, 2u),
    Run(310u, 135u, 3u),
    Run(311u, 104u, 2u),
    Run(311u, 115u, 2u),
    Run(311u, 118u, 2u),
    Run(311u, 134u, 1u),
    Run(312u, 103u, 1u),
    Run(312u, 116u, 3u),
    Run(312u, 134u, 2u),
    Run(316u, 114u, 2u),
    Run(316u, 132u, 1u),
    Run(317u, 96u, 1u),
    Run(317u, 115u, 1u),
    Run(317u, 125u, 1u),
    Run(317u, 127u, 1u),
    Run(317u, 130u, 2u),
    Run(317u, 133u, 2u),
    Run(318u, 96u, 2u),
    Run(318u, 112u, 3u),
    Run(318u, 125u, 2u),
    Run(319u, 95u, 1u),
    Run(319u, 97u, 1u),
    Run(319u, 112u, 1u),
    Run(319u, 126u, 1u),
    Run(319u, 129u, 1u),
    Run(319u, 135u, 1u),
    Run(321u, 129u, 2u),
    Run(321u, 132u, 1u),
    Run(321u, 134u, 2u),
    Run(324u, 119u, 1u),
    Run(325u, 88u, 2u),
    Run(325u, 117u, 2u),
    Run(326u, 89u, 2u),
    Run(326u, 118u, 2u),
    Run(327u, 88u, 1u),
    Run(329u, 129u, 2u),
    Run(330u, 130u, 1u),
    Run(331u, 127u, 3u),
    Run(332u, 81u, 1u),
    Run(332u, 110u, 1u),
    Run(332u, 112u, 1u),
    Run(332u, 127u, 1u),
    Run(333u, 81u, 2u),
    Run(333u, 110u, 2u),
    Run(334u, 80u, 1u),
    Run(334u, 82u, 1u),
    Run(334u, 111u, 1u),
    Run(340u, 73u, 2u),
    Run(341u, 74u, 2u),
    Run(342u, 73u, 1u),
    Run(347u, 95u, 1u),
    Run(347u, 97u, 1u),
    Run(348u, 95u, 2u),
    Run(349u, 96u, 1u),
    Run(355u, 58u, 2u),
    Run(356u, 59u, 2u),
    Run(357u, 58u, 1u),
    Run(362u, 51u, 1u),
    Run(362u, 80u, 1u),
    Run(362u, 82u, 1u),
    Run(363u, 51u, 2u),
    Run(363u, 80u, 2u),
    Run(364u, 50u, 1u),
    Run(364u, 52u, 1u),
    Run(364u, 81u, 1u),
    Run(370u, 43u, 2u),
    Run(371u, 44u, 2u),
    Run(372u, 43u, 1u),
    Run(377u, 36u, 1u),
    Run(377u, 65u, 1u),
    Run(377u, 67u, 1u),
    Run(378u, 36u, 2u),
    Run(378u, 65u, 2u),
    Run(379u, 35u, 1u),
    Run(379u, 37u, 1u),
    Run(379u, 66u, 1u),
    Run(384u, 59u, 1u),
    Run(385u, 28u, 2u),
    Run(385u, 57u, 2u),
    Run(386u, 29u, 2u),
    Run(386u, 58u, 2u),
    Run(387u, 2u, 1u),
    Run(387u, 28u, 1u),
    Run(388u, 2u, 3u),
    Run(389u, 5u, 1u),
    Run(390u, 4u, 2u),
    Run(392u, 21u, 1u),
    Run(392u, 50u, 1u),
    Run(392u, 52u, 1u),
    Run(393u, 21u, 2u),
    Run(393u, 50u, 2u),
    Run(394u, 20u, 1u),
    Run(394u, 22u, 1u),
    Run(394u, 51u, 1u),
    Run(399u, 44u, 1u),
    Run(400u, 4u, 2u),
    Run(400u, 9u, 2u),
    Run(400u, 13u, 2u),
    Run(400u, 42u, 2u),
    Run(401u, 6u, 3u),
    Run(401u, 14u, 2u),
    Run(401u, 43u, 2u),
    Run(402u, 5u, 1u),
    Run(402u, 9u, 1u),
    Run(402u, 13u, 1u),
    Run(403u, 6u, 1u),
    Run(403u, 8u, 1u),
    Run(404u, 7u, 1u),
    Run(407u, 4u, 2u),
    Run(407u, 35u, 1u),
    Run(407u, 37u, 1u),
    Run(408u, 5u, 1u),
    Run(408u, 35u, 2u),
    Run(409u, 2u, 3u),
    Run(409u, 36u, 1u),
    Run(410u, 2u, 1u),
    Run(416u, 19u, 2u),
    Run(417u, 5u, 2u),
    Run(417u, 19u, 1u),
    Run(417u, 21u, 1u),
    Run(418u, 6u, 1u),
    Run(418u, 19u, 1u),
    Run(419u, 6u, 1u),
    Run(419u, 8u, 1u),
    Run(419u, 14u, 2u),
    Run(420u, 7u, 2u),
    Run(420u, 14u, 1u),
    Run(420u, 17u, 1u),
    Run(421u, 18u, 1u),
    Run(422u, 18u, 1u),
    Run(423u, 18u, 1u),
    Run(424u, 14u, 1u),
    Run(424u, 17u, 1u),
    Run(424u, 24u, 2u),
    Run(425u, 14u, 2u),
    Run(425u, 24u, 1u),
    Run(425u, 26u, 1u),
    Run(426u, 26u, 1u),
    Run(427u, 26u, 2u)
);

struct ShaderUniforms
{
    iResolution : vec3f,
    iTime : f32,
    iTimeDelta : f32,
    iFrame : u32,
    iFrameRate : f32,
    iMouse : vec4f,
    iGridSize : vec3u,
};

@group(0) @binding(0) var<uniform> shaderUniforms : ShaderUniforms;
@group(0) @binding(1) var<storage, read_write> cellStateIn: array<u32>;
@group(0) @binding(2) var<storage, read_write> cellStateOut: array<u32>;

fn cellIndex(cell: vec2u) -> u32
{
    return cell.y * shaderUniforms.iGridSize.x + cell.x;
}

fn cellActive(x: u32, y: u32) -> u32
{
    if (x >= shaderUniforms.iGridSize.x || y >= shaderUniforms.iGridSize.y)
    {
        return 0u;
    }

    return cellStateIn[cellIndex(vec2(x, y))];
}

fn getCellState(x: u32, y: u32) -> u32
{
    return cellActive(x, y);
}

fn setCellState(x: u32, y: u32, state: u32)
{
    cellStateOut[cellIndex(vec2(x, y))] = state;
}

fn initCellState(x: u32, y: u32)
{
    if (x != 0u || y != 0u)
    {
        return;
    }

    let grid = shaderUniforms.iGridSize;
    if (grid.x < PATTERN_WIDTH || grid.y < PATTERN_HEIGHT)
    {
        return;
    }

    let gridCount = grid.x * grid.y;
    for (var i = 0u; i < gridCount; i = i + 1u)
    {
        cellStateOut[i] = 0u;
    }

    let offset = vec2u((grid.x - PATTERN_WIDTH) / 2u, (grid.y - PATTERN_HEIGHT) / 2u);

    for (var i = 0u; i < PATTERN_RUN_COUNT; i = i + 1u)
    {
        let run = PATTERN_RUNS[i];
        let rowOffset = (run.y + offset.y) * grid.x + run.x + offset.x;

        for (var dx = 0u; dx < run.len; dx = dx + 1u)
        {
            cellStateOut[rowOffset + dx] = 1u;
        }
    }
}

fn countActiveNeighbors(cell: vec2u) -> u32
{
    return cellActive(cell.x + 1u, cell.y + 1u)
         + cellActive(cell.x + 1u, cell.y     )
         + cellActive(cell.x + 1u, cell.y - 1u)
         + cellActive(cell.x     , cell.y - 1u)
         + cellActive(cell.x - 1u, cell.y - 1u)
         + cellActive(cell.x - 1u, cell.y     )
         + cellActive(cell.x - 1u, cell.y + 1u)
         + cellActive(cell.x     , cell.y + 1u);
}

fn applyGameOfLifeRules(cell: vec2u, activeNeighbors: u32)
{
    let currentState = getCellState(cell.x, cell.y);
    var nextState: u32;

    if (activeNeighbors == 3u)
    {
        // Rule 1: Survivals. Every counter with two or three neighboring counters survives for the next generation.
        // Rule 3: Births. Each empty cell adjacent to exactly three live neighbors becomes a live cell.
        // Cells with 3 neighbors become or stay active.
        nextState = 1u;
    }
    else if (activeNeighbors == 2u)
    {
        // Rule 1: Survivals. Every counter with two or three neighboring counters survives for the next generation.
        // Cells with 2 neighbors preserve their state.
        nextState = currentState;
    }
    else
    {
        // Rule 2: Deaths. Any live cell with fewer than two live neighbors dies, as if caused by under-population.
        // Cells with less than 2 or more then 3 neighbors become inactive.
        nextState = 0u;
    }

    setCellState(cell.x, cell.y, nextState);
}

fn applyMouseOverride(cell: vec2u) -> bool
{
    if (shaderUniforms.iMouse.z <= 0.0)
    {
        return false;
    }

    let grid = vec2f(f32(shaderUniforms.iGridSize.x), f32(shaderUniforms.iGridSize.y));
    let cellSize = shaderUniforms.iResolution.xy / grid;
    let mousePos = clamp(shaderUniforms.iMouse.xy, vec2f(0.0), shaderUniforms.iResolution.xy - vec2f(1.0));
    let mouseCell = vec2u(mousePos / cellSize);
    let dx = abs(i32(cell.x) - i32(mouseCell.x));
    let dy = abs(i32(cell.y) - i32(mouseCell.y));

    // if (max(dx, dy) <= 2)    // 5x5 brush
    if (dx == 0 && dy == 0)     // 1x1 brush
    {
        setCellState(cell.x, cell.y, 1u);
        return true;
    }

    return false;
}

@compute @workgroup_size(16, 16)
fn main(@builtin(global_invocation_id) cell : vec3u)
{
    // Initialize cell state on the first frame.
    if (shaderUniforms.iFrame == 0u)
    {
        initCellState(cell.x, cell.y);
        return;
    }

    if (applyMouseOverride(cell.xy))
    {
        return;
    }

    // Computation speed control: update every Nth frame
    if (shaderUniforms.iFrame % COMPUTE_FRAME_INTERVAL != 0u)
    {
        setCellState(cell.x, cell.y, getCellState(cell.x, cell.y));
        return;
    }

    let activeNeighbors = countActiveNeighbors(cell.xy);
    applyGameOfLifeRules(cell.xy, activeNeighbors);
}
